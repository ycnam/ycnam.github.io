---
import { getArchiveData, getPostsByMonth } from '../../../lib/archives';
import BaseLayout from '../../../layouts/BaseLayout.astro';
import PostCard from '../../../components/PostCard.astro';

export async function getStaticPaths() {
  const archiveData = await getArchiveData();
  return archiveData.flatMap(yearData =>
    yearData.months.map(monthData => ({
      params: { year: String(yearData.year), month: String(monthData.month).padStart(2, '0') },
      props: { year: yearData.year, month: monthData.month }
    }))
  );
}

const { year, month } = Astro.props;
const posts = await getPostsByMonth(year, month);
---

<BaseLayout title={`${year}년 ${month}월 아카이브`}>
  <h1 class="archive-heading">{year}년 {month}월</h1>
  {posts.map(post => (
    <PostCard post={post} />
  ))}
</BaseLayout>

<style>
  .archive-heading {
    font-family: Georgia, serif;
    font-size: 1.25rem;
    margin: 0 0 1.5rem 0;
    color: var(--color-muted);
  }
</style>
